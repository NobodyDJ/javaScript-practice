<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>防抖</title>
</head>

<body>
    <button id="debounce">点我防抖！</button>

    <script>
        // 防抖：任务频繁触发的情况下，只有任务触发的间隔超过指定间隔的时候，任务才会执行。
        window.onload = function () {
            // 1、获取这个按钮，并绑定事件
            var myDebounce = document.getElementById("debounce");
            myDebounce.addEventListener("click", debounce(sayDebounce, 1000));
        }

        // 2、防抖功能函数，接受传参
        function debounce(fn, delay) {
            let timer;// 利用闭包的原理，如果不把Timer放到外面则clearTimeout这个函数没有作用
            return function () {
                clearTimeout(timer);
                let context = this
                timer = setTimeout(() => {
                    fn.apply(context, arguments); //将上下文始终绑定执行该函数的上下文，这里指的是#debounce这个DOM元素
                    // fn();
                }, delay);
            }
        }

        // 3、需要进行防抖的事件处理
        function sayDebounce() {
            // ... 有些需要防抖的工作，在这里执行
            let str = "防抖成功！"
            console.log(this);
            console.log(str);
        }

    </script>
</body>

</html>